{{> navigation}}
{{> breadcrumb}}
<section>
    <div class="container">
        {{> sideMenu}}
        <div class="col-md-9">
            <div class="content">
                <h1><span>{{data.form.title}}</span></h1>
                {{{data.form.content}}}
                {{{data.form.form}}}
                <div class="confirmationMessage" style="display:none;">
                    <hr>
                    {{#if data.form.confirmationMessage}}
                        {{{data.form.confirmationMessage}}}
                    {{else}}
                        <p>Thanks for contacting us.  We will get back to you as soon as possible.</p>
                    {{/if}}
                </div>
                <input type="hidden" id="form-name" value="{{filters.form}}"/>
            </div>
        </div>
    </div>
    </div>
</section>
<script type="text/javascript">
    $(function () {
        $('.content form').append('<div class="form-group"><div class="col-md-4 col-md-offset-4"> <button type="submit" id="submit-form" class="btn btn-lead btn-lg">Submit</button></div></div>');
        $('.content form').on('click', '#submit-form', function(e){
            e.preventDefault();
            $.ajax({
                url: '/api/form',
                type:'POST',
                data: {
                    form: $('#form-name').val(),
                    response: $('.content form').serializeArray()
                },
                success:function(result){
                    if(result.success){
                        $('.content form').hide();
                        $('.confirmationMessage').show();
                    }
                },
                error:function(){
                    $('.content form').before('<p>There was an error processing your message.  Please try sending again.</p>');
                }
            })
        });
        $('.datetimepicker').datetimepicker();
    });
</script>
